{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://scitex.ai/schemas/fts/node.schema.json",
  "title": "FTS Node Schema",
  "description": "Schema for FTS bundle node specification",
  "type": "object",
  "required": ["id", "kind", "bbox_norm"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier (UUID) for this node"
    },
    "kind": {
      "type": "string",
      "enum": ["figure", "plot", "table", "stats", "text", "shape", "image"],
      "description": "Node kind: figure (composite), plot/table/stats/text/shape/image (leaf)"
    },
    "name": {
      "type": "string",
      "description": "Human-readable name"
    },
    "scitex_schema": {
      "type": "string",
      "description": "Schema identifier",
      "default": "scitex.fts.spec"
    },
    "scitex_schema_version": {
      "type": "string",
      "description": "Schema version",
      "default": "1.0.0"
    },
    "bbox_norm": {
      "type": "object",
      "description": "Bounding box in normalized coordinates (0-1)",
      "required": ["x0", "y0", "x1", "y1"],
      "properties": {
        "x0": {"type": "number", "minimum": 0, "maximum": 1},
        "y0": {"type": "number", "minimum": 0, "maximum": 1},
        "x1": {"type": "number", "minimum": 0, "maximum": 1},
        "y1": {"type": "number", "minimum": 0, "maximum": 1}
      }
    },
    "size_mm": {
      "type": "object",
      "description": "Physical size in millimeters",
      "properties": {
        "width": {"type": "number", "minimum": 0},
        "height": {"type": "number", "minimum": 0}
      }
    },
    "axes": {
      "type": "object",
      "description": "Axis configuration (for plot nodes)",
      "properties": {
        "xlim": {
          "type": "array",
          "items": {"type": "number"},
          "minItems": 2,
          "maxItems": 2
        },
        "ylim": {
          "type": "array",
          "items": {"type": "number"},
          "minItems": 2,
          "maxItems": 2
        },
        "xscale": {"type": "string", "enum": ["linear", "log", "symlog"]},
        "yscale": {"type": "string", "enum": ["linear", "log", "symlog"]},
        "xlabel": {"type": "string"},
        "ylabel": {"type": "string"}
      }
    },
    "children": {
      "type": "array",
      "description": "Child node references (for figure composite kind only)",
      "items": {"type": "string"}
    },
    "layout": {
      "type": "object",
      "description": "Layout configuration for composite figures",
      "properties": {
        "rows": {"type": "integer", "minimum": 1},
        "cols": {"type": "integer", "minimum": 1},
        "panels": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "child": {"type": "string"},
              "child_id": {"type": "string"},
              "label": {"type": "string"},
              "row": {"type": "integer"},
              "col": {"type": "integer"},
              "row_span": {"type": "integer", "default": 1},
              "col_span": {"type": "integer", "default": 1}
            }
          }
        }
      }
    },
    "payload_schema": {
      "type": "string",
      "description": "Payload schema for leaf kinds (e.g., scitex.fts.payload.plot@1)"
    },
    "text": {
      "type": "object",
      "description": "Text content (for kind=text)",
      "properties": {
        "content": {"type": "string"},
        "fontsize": {"type": "number"},
        "fontweight": {"type": "string"},
        "ha": {"type": "string", "enum": ["left", "center", "right"]},
        "va": {"type": "string", "enum": ["top", "center", "bottom"]}
      }
    },
    "shape": {
      "type": "object",
      "description": "Shape parameters (for kind=shape)",
      "properties": {
        "shape_type": {"type": "string", "enum": ["rectangle", "ellipse", "arrow", "line"]},
        "color": {"type": "string"},
        "linewidth": {"type": "number"},
        "fill": {"type": "boolean"}
      }
    },
    "refs": {
      "type": "object",
      "description": "References to associated files",
      "properties": {
        "encoding": {"type": "string"},
        "theme": {"type": "string"},
        "data": {"type": "string"},
        "stats": {"type": "string"}
      }
    },
    "created_at": {
      "type": "string",
      "format": "date-time"
    },
    "modified_at": {
      "type": "string",
      "format": "date-time"
    }
  }
}
